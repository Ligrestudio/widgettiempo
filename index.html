<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pronóstico del Tiempo en Oropesa del Mar</title>
  </head>
  <body>
    <div id="tiempo">
      <!-- Aquí se mostrarán los datos del tiempo -->
    </div>

    <script>
      const url =
        'https://www.el-tiempo.net/api/json/v2/provincias/12/municipios/12085'

      fetch(url)
        .then((response) => {
          if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`)
          }
          return response.json()
        })
        .then((data) => {
          console.log('Raw API data:', data) // Verifica los datos recibidos en la consola
          mostrarPronostico(data)
        })
        .catch((error) => {
          console.error('Error al obtener los datos:', error)
          document.getElementById('tiempo').innerHTML =
            'No se pudo obtener la información del tiempo.'
        })

      function mostrarPronostico(data) {
        const tiempoDiv = document.getElementById('tiempo')
        tiempoDiv.innerHTML = ''

        const hoy = data.pronostico.hoy
        const { salidaSol, puestaSol } = data

        // Primer bloque: Temperatura grande y nombre de la ciudad
        tiempoDiv.innerHTML += `
        <div class="bloque head">
            <div class="temperatura-grande">${hoy.temperatura_actual}°</div>
            <div class="ciudad">Oropesa del Mar</div>
        </div>
    `

        // Segundo bloque: Horas de salida y puesta del sol
        tiempoDiv.innerHTML += `
        <div class="bloque">
            <div class="columna">
                <p>Salida del sol</p>
                <p>${salidaSol}</p>
            </div>
            <div class="columna">
                <p>Puesta del sol</p>
                <p>${puestaSol}</p>
            </div>
        </div>
    `

        // Tercer bloque: Pronóstico por hora (cada 3 horas)
        const horasDiv = document.createElement('div')
        horasDiv.className = 'bloque'

        hoy.pronostico_horario.forEach((item, index) => {
          horasDiv.innerHTML += `
      <div class="columna">
        <h3 class="hora">${item.hora}</h3>
        <img src="https://www.el-tiempo.net/assets/api/icons/${item.icono}.svg" alt="Icono del tiempo">
        <p>${item.temperatura} °C</p>
      </div>
    `
        })
        tiempoDiv.appendChild(horasDiv)

        // Cuarto bloque: Pronóstico por día (mañana)
        const manana = data.pronostico.manana
        const diasDiv = document.createElement('div')
        diasDiv.className = 'bloque'

        diasDiv.innerHTML += `
                    <div class="columna dia">
                        <h3>Mañana</h3>
                        <img src="https://www.el-tiempo.net/assets/api/icons/${manana.icono}.svg" alt="Icono del tiempo">
                        <p>${manana.temperatura_max}°C / ${manana.temperatura_min}°C</p>
                    </div>
                `
        tiempoDiv.appendChild(diasDiv)
      }
    </script>
  </body>
</html>
